<!-- Include the ZooZ script that contains the zoozStartCheckout() function -->
<script src="https://app.zooz.com/mobile/js/zooz-ext-web.js"></script>


<script type="text/javascript">
	
	$(document).ready(function(){
		$('#checkoutButton').click(function() {
			$.ajax({
				url: '/purchase_package/' + <%= @party_package.id.to_s %>, // A call to server side to initiate the payment process
				dataType: 'html',
				cache: false,
				success: function(response) {
					alert("RESPONSE: " + response);
					eval(response);
					var path = window.location.protocol + "//" + window.location.host + "/zooz_response";
					
					zoozStartCheckout({
						token : data.token,									// Session token recieved from server
						uniqueId : "com.cabforward.foamfinger",				// unique ID as registered in the developer portal
						isSandbox : true,									// true = Sandbox environment
						returnUrl : path + "/return.jsp",					// return page URL
						cancelUrl : path + "/failed.jsp"					// cancel page URL
						
					});
				}
			});
			
		});
				
	});
</script>

	<div data-role="page" data-theme="b">
		<div data-role="content" data-contnet-theme="b">

			<table id="wrapper">
				<tr>
					<td><h3>Buy <i><%= @party_package.name %></i> for <%= number_to_currency(@party_package.price)%>!</h3></td>
				</tr>

				<tr>
					<td><%= image_tag(@party_package.image_url, size: '150') unless @party_package.image_url.blank? %></td>
				</tr>
			</table>
			<button id="checkoutButton">Buy now</button>

		</div>
	</div>
